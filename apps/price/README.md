# 价格查询工具 (Price Tool)

## 概述

价格查询工具是一个用于实时监控加密货币价格和资产信息的应用程序。它可以定期获取指定交易对的最新价格、24小时涨跌幅、交易量等信息，并提供资产查询功能，帮助用户实时了解市场行情和自己的资产状况。

## 功能特点

- **实时价格监控**：定期获取指定交易对的最新价格
- **资产查询**：查询账户资产信息，包括总资产、理财、资金和交易账户
- **历史数据分析**：计算并显示昨日涨跌幅、昨日成交量和量比等指标
- **自定义刷新间隔**：可配置数据刷新频率
- **多种输出方式**：支持控制台输出和日志文件记录

## 安装和配置

1. 确保已安装所需的依赖：
   ```bash
   pip install prettytable
   ```

2. 配置 `config/price.json` 文件：
   ```json
   {
     "app_name": "price",
     "logging": {
       "level": "INFO",
       "file": "price.log",
       "output_targets": ["file", "console"]
     },
     "exchange": {
       "type": "okex",
       "api_key": "你的API密钥",
       "secret_key": "你的密钥",
       "passphrase": "你的密码",
       "is_simulated": false
     },
     "instruments": [
       "BTC-USDT",
       "BTC-USDT-SWAP",
       "ETH-USDT",
       "ETH-USDT-SWAP"
     ],
     "asset_params": {
       "ccy": "USD"
     },
     "refresh_interval": 30,
     "output_format": {
       "type": "table",
       "include_timestamp": true,
       "precision": 4
     }
   }
   ```

## 使用方法

1. 复制示例配置文件：
   ```bash
   cp config/price.example.json config/price.json
   ```

2. 修改配置文件，填入您的 API 密钥和其他参数

3. 运行应用程序：
   ```bash
   python apps/price/get_price.py
   ```

## 配置说明

- **app_name**: 应用名称，用于日志和配置文件识别
- **logging**: 日志配置
  - **level**: 日志级别 (INFO, DEBUG, WARNING, ERROR)
  - **file**: 日志文件名
  - **output_targets**: 日志输出目标 (file, console)
- **exchange**: 交易所 API 配置
  - **type**: 交易所类型，目前支持okex
  - **api_key**: 交易所 API 密钥，用于身份验证
  - **secret_key**: 交易所密钥，用于签名请求
  - **passphrase**: 交易所API密码，OKEx特有的参数
  - **is_simulated**: 是否为模拟交易，true为模拟环境，false为实盘交易
- **instruments**: 要监控的交易对列表
- **asset_params**: 资产查询参数
  - **ccy**: 资产计价货币
- **refresh_interval**: 数据刷新间隔 (秒)
- **output_format**: 输出格式配置
  - **type**: 输出类型，可选table(表格)、json(JSON格式)、csv(CSV格式)
  - **include_timestamp**: 是否在输出中包含时间戳
  - **precision**: 价格和数量的小数点精度

## 输出示例

应用程序运行后，会在控制台显示类似以下的输出：

```
=== 资产信息 ===
+---------------+------+------+------+
| 总资产(USD)   | 理财 | 资金 | 交易 |
+---------------+------+------+------+
| 1234.56       | 0    | 1000 | 234  |
+---------------+------+------+------+

=== 行情数据 ===
+------------+--------+-------+-------+---------+------------+-----------+-------------+------+
| 交易对     | 最新价 | 24h高 | 24h低 | 涨跌幅  | 24h成交量  | 昨日涨跌  | 昨日成交量  | 量比 |
+------------+--------+-------+-------+---------+------------+-----------+-------------+------+
| BTC-USDT   | 65000  | 66000 | 64000 | 1.5%    | 1000.5     | 0.8%      | 900.3       | 1.2  |
| ETH-USDT   | 3500   | 3600  | 3400  | 2.1%    | 2000.7     | -0.5%     | 1800.2      | 1.3  |
+------------+--------+-------+-------+---------+------------+-----------+-------------+------+

等待 30 秒后刷新...
```

## 注意事项

1. **API 安全**：
   - 请确保 API 密钥的权限设置合理，建议只开启读取权限
   - 不要将包含 API 密钥的配置文件提交到版本控制系统

2. **使用建议**：
   - 合理设置刷新间隔，避免频繁请求导致 API 限制
   - 监控日志文件，及时发现并处理异常情况

3. **数据说明**：
   - 量比 = (昨日成交量 + 今日成交量) / 昨日成交量 * 0.8
   - 昨日涨跌 = (昨日收盘价 - 昨日开盘价) / 昨日开盘价 * 100%

## 开发计划

1. **功能扩展**：
   - 添加价格提醒功能
   - 支持更多交易所
   - 添加图表展示功能

2. **性能优化**：
   - 优化数据获取逻辑，减少 API 调用次数
   - 实现数据缓存机制

3. **用户体验**：
   - 提供更丰富的数据展示方式
   - 添加命令行参数支持 